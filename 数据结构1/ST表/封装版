#include <bits/stdc++.h>
using namespace std;

using i64=long long;
using u64=unsigned long long;

template <typename T>
struct ST {
    vector<vector<T>> st;

    explicit ST(const vector<T> &v): st() {
        u64 len=v.size(),d=bit_width(bit_ceil(len));//bit_ceil(len)不小于len的最小2的幂（先log2再加1）
        st.assign(len,vector<T>(d));

        for (int i=0;i<len;i++) st[i][0]=v[i];
        for (int j=1;j<d;j++) {//区间长度
            for (int i=0;i+(1<<(j-1))<len;i++) {
                st[i][j]=T::merge(st[i][j-1],st[i+(1<<(j-1))][j-1]);
            }
        }
    }

    T query(u64 l,u64 r){
        u64 d=bit_width(bit_floor(r-l+1));
        return T::merge(st[l][d-1],st[r-(1<<(d-1))+1][d-1]);
    }

};

struct info {
    i64 val=0;

    static info merge(const info&a,const info&b) {
        return {min(a.val,b.val)};
    }
};

void solve() {
    u64 n,m;
    cin>>n>>m;
    vector<info> a(n+1);
    for (i64 i=1;i<=n;i++) cin>>a[i].val;

    ST<info> st(a);
    while (m--) {
        i64 l,r;
        cin>>l>>r;
        cout<<st.query(l,r).val<<" ";
    }
}
